<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÿßŸÑŸÖÿ™ÿ±ÿ¨ŸÖ ÿßŸÑÿπÿ®ŸÇÿ±Ÿä | ÿ±ÿ≠ŸÑÿ© ŸÅŸä ÿßŸÑŸÑŸáÿ¨ÿßÿ™</title>
    
    <!-- Fonts: 'Rakkas' for titles (Heritage look), 'Tajawal' for UI -->
    <link href="https://fonts.googleapis.com/css2?family=Rakkas&family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Tajawal', 'sans-serif'],
                        serif: ['Rakkas', 'serif'],
                    },
                    colors: {
                        sand: {
                            50: '#fdfbf7',
                            100: '#f7f1e3',
                            200: '#efe2c5',
                            300: '#e5cd9e',
                            400: '#dcb374',
                            500: '#d49a4f', // Main Gold/Sand
                            600: '#c67e3e',
                            800: '#8c532e', // Earthy Brown
                            900: '#5c351d',
                        },
                        turquoise: '#009796', // Islamic Art Blue/Green
                        clay: '#b65d48',
                    },
                    backgroundImage: {
                        'arabesque': "url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d49a4f' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")",
                    },
                    animation: {
                        'fade-up': 'fadeUp 0.6s ease-out forwards',
                        'spin-slow': 'spin 8s linear infinite',
                    },
                    keyframes: {
                        fadeUp: {
                            '0%': { opacity: 0, transform: 'translateY(20px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.263.1"
            }
        }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #fdfbf7;
            color: #5c351d;
        }
        
        /* Card Hover Effect */
        .dialect-card {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .dialect-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px -10px rgba(140, 83, 46, 0.3);
        }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #dcb374; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Languages, Globe, ArrowRightLeft, Copy, Check, 
            Settings, Key, X, Sparkles, Map, BookOpen, 
            Palmtree, Triangle, Mountain
        } from 'lucide-react';

        // --- Mock Data (Demo Mode) ---
        const DEMO_TRANSLATION = [
            { id: 'egypt', name: 'ÿßŸÑŸÖÿµÿ±Ÿäÿ©', flag: 'üá™üá¨', icon: Triangle, text: "ÿ•ÿ≤ŸäŸÉ Ÿäÿß ÿµÿßÿ≠ÿ®Ÿäÿü ÿπÿßŸÖŸÑ ÿ•ŸäŸáÿü Ÿàÿ≠ÿ¥ŸÜŸä ŸàÿßŸÑŸÑŸá.", note: "ÿ•ÿ≤ŸäŸÉ: ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉ | Ÿàÿ≠ÿ¥ŸÜŸä: ÿßÿ¥ÿ™ŸÇÿ™ ŸÑŸÉ" },
            { id: 'levant', name: 'ÿßŸÑÿ¥ÿßŸÖŸäÿ©', flag: 'üá±üáß', icon: Mountain, text: "ŸÉŸäŸÅŸÉ ÿÆŸäŸäÿü ÿ¥Ÿà ÿ£ÿÆÿ®ÿßÿ±ŸÉÿü ÿßÿ¥ÿ™ŸÇÿ™ŸÑŸÉ ŸÉÿ™Ÿäÿ±.", note: "ÿ¥Ÿà: ŸÖÿßÿ∞ÿß | ÿÆŸäŸä: ÿ£ÿÆŸä" },
            { id: 'gulf', name: 'ÿßŸÑÿÆŸÑŸäÿ¨Ÿäÿ©', flag: 'üá∏üá¶', icon: Palmtree, text: "ÿ¥ŸÑŸàŸÜŸÉ Ÿäÿß ÿÆŸàŸäÿü ÿπÿ≥ÿßŸÉ ÿ∑Ÿäÿ®ÿü ŸàŸÑŸáÿ™ ÿπŸÑŸäŸÉ.", note: "ÿ¥ŸÑŸàŸÜŸÉ: ŸÉŸäŸÅ ŸÑŸàŸÜŸÉ (ÿ≠ÿßŸÑŸÉ) | ŸàŸÑŸáÿ™: ÿßÿ¥ÿ™ŸÇÿ™" },
            { id: 'morocco', name: 'ÿßŸÑŸÖÿ∫ÿ±ÿ®Ÿäÿ©', flag: 'üá≤üá¶', icon: Map, text: "ŸÉŸäÿØÿßŸäÿ± ÿ£ÿÆŸàŸäÿßÿü ŸÑÿ®ÿßÿ≥ ÿπŸÑŸäŸÉÿü ÿ™Ÿàÿ≠ÿ¥ÿ™ŸÉ ÿ®ÿ≤ÿßŸÅ.", note: "ŸÉŸäÿØÿßŸäÿ±: ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉ | ÿ®ÿ≤ÿßŸÅ: ŸÉÿ´Ÿäÿ±ÿßŸã" },
            { id: 'iraq', name: 'ÿßŸÑÿπÿ±ÿßŸÇŸäÿ©', flag: 'üáÆüá∂', icon: Globe, text: "ÿ¥ŸÑŸàŸÜŸÉ ÿπŸäŸÜŸäÿü ÿ¥ŸÉŸà ŸÖÿßŸÉŸàÿü ŸÖÿ¥ÿ™ÿßŸÇŸÑŸÉ ŸáŸàÿßŸäÿ©.", note: "ÿ¥ŸÉŸà ŸÖÿßŸÉŸà: ŸÖÿß ÿßŸÑÿ£ÿÆÿ®ÿßÿ± | ŸáŸàÿßŸäÿ©: ŸÉÿ´Ÿäÿ±ÿßŸã" },
        ];

        // --- Components ---

        function App() {
            // Inputs
            const [inputText, setInputText] = useState('');
            const [results, setResults] = useState(null);
            
            // System
            const [isTranslating, setIsTranslating] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [apiKey, setApiKey] = useState(() => localStorage.getItem('gemini_api_key') || '');
            const [copiedId, setCopiedId] = useState(null);

            const saveApiKey = (key) => {
                setApiKey(key);
                localStorage.setItem('gemini_api_key', key);
            };

            const handleCopy = (text, id) => {
                navigator.clipboard.writeText(text);
                setCopiedId(id);
                setTimeout(() => setCopiedId(null), 2000);
            };

            const handleTranslate = async () => {
                if (!inputText.trim()) return;
                setIsTranslating(true);
                setResults(null);

                // Demo Mode
                if (!apiKey) {
                    setTimeout(() => {
                        setResults(DEMO_TRANSLATION);
                        setIsTranslating(false);
                    }, 2000);
                    return;
                }

                // AI Prompt
                const prompt = `ÿ£ŸÜÿ™ ÿÆÿ®Ÿäÿ± ŸÑÿ∫ŸàŸä ŸÅŸä ÿßŸÑŸÑŸáÿ¨ÿßÿ™ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©. 
                ŸÇŸÖ ÿ®ÿ™ÿ±ÿ¨ŸÖÿ© ÿßŸÑÿ¨ŸÖŸÑÿ© ÿßŸÑÿ™ÿßŸÑŸäÿ© ŸÖŸÜ ÿßŸÑŸÅÿµÿ≠Ÿâ: "${inputText}"
                ÿ•ŸÑŸâ ÿßŸÑŸÑŸáÿ¨ÿßÿ™ ÿßŸÑÿ™ÿßŸÑŸäÿ©: (ÿßŸÑŸÖÿµÿ±Ÿäÿ©ÿå ÿßŸÑÿ¥ÿßŸÖŸäÿ©ÿå ÿßŸÑÿÆŸÑŸäÿ¨Ÿäÿ©ÿå ÿßŸÑŸÖÿ∫ÿ±ÿ®Ÿäÿ©ÿå ÿßŸÑÿπÿ±ÿßŸÇŸäÿ©).
                
                ŸÑŸÉŸÑ ŸÑŸáÿ¨ÿ©ÿå ÿ£ÿ∂ŸÅ ÿ¥ÿ±ÿ≠ÿßŸã ÿ®ÿ≥Ÿäÿ∑ÿßŸã ŸÑŸÉŸÑŸÖÿ© ÿ£Ÿà ŸÉŸÑŸÖÿ™ŸäŸÜ ÿπÿßŸÖŸäÿ™ŸäŸÜ ÿ™ŸÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖŸáŸÖÿß (ÿ•ŸÜ Ÿàÿ¨ÿØ).

                ÿßŸÑŸÖÿÆÿ±ÿ¨ÿßÿ™ JSON ŸÅŸÇÿ∑ ÿ®Ÿáÿ∞Ÿá ÿßŸÑÿµŸäÿ∫ÿ©:
                [
                    { "id": "egypt", "name": "ÿßŸÑŸÖÿµÿ±Ÿäÿ©", "text": "ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©", "note": "ÿßŸÑÿ¥ÿ±ÿ≠" },
                    { "id": "levant", "name": "ÿßŸÑÿ¥ÿßŸÖŸäÿ©", "text": "ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©", "note": "ÿßŸÑÿ¥ÿ±ÿ≠" },
                    { "id": "gulf", "name": "ÿßŸÑÿÆŸÑŸäÿ¨Ÿäÿ©", "text": "ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©", "note": "ÿßŸÑÿ¥ÿ±ÿ≠" },
                    { "id": "morocco", "name": "ÿßŸÑŸÖÿ∫ÿ±ÿ®Ÿäÿ©", "text": "ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©", "note": "ÿßŸÑÿ¥ÿ±ÿ≠" },
                    { "id": "iraq", "name": "ÿßŸÑÿπÿ±ÿßŸÇŸäÿ©", "text": "ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©", "note": "ÿßŸÑÿ¥ÿ±ÿ≠" }
                ]`;

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            contents: [{ parts: [{ text: prompt }] }],
                            generationConfig: { responseMimeType: "application/json" }
                        })
                    });
                    const data = await response.json();
                    const parsed = JSON.parse(data.candidates[0].content.parts[0].text);
                    
                    // Map icons/flags to result
                    const enrichedResults = parsed.map(item => {
                        const demoMatch = DEMO_TRANSLATION.find(d => d.id === item.id);
                        return { ...item, flag: demoMatch?.flag, icon: demoMatch?.icon };
                    });

                    setResults(enrichedResults);
                } catch (error) {
                    console.error(error);
                    setResults(DEMO_TRANSLATION); // Fallback to demo on error
                } finally {
                    setIsTranslating(false);
                }
            };

            return (
                <div className="min-h-screen bg-sand-50 bg-arabesque relative flex flex-col font-sans">
                    
                    {/* Header */}
                    <header className="bg-white/80 backdrop-blur-md border-b border-sand-200 sticky top-0 z-40">
                        <div className="container mx-auto px-4 h-20 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="w-12 h-12 bg-turquoise text-white rounded-full flex items-center justify-center shadow-lg transform rotate-45">
                                    <div className="transform -rotate-45 font-serif text-2xl">ÿπ</div>
                                </div>
                                <div>
                                    <h1 className="text-3xl font-serif text-sand-900 leading-none">ÿßŸÑŸÖÿ™ÿ±ÿ¨ŸÖ ÿßŸÑÿπÿ®ŸÇÿ±Ÿä</h1>
                                    <p className="text-xs text-sand-600 font-bold tracking-wide mt-1">ÿ±ÿ≠ŸÑÿ© ŸÅŸä ÿßŸÑŸÑŸáÿ¨ÿßÿ™ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</p>
                                </div>
                            </div>
                            <button onClick={() => setShowSettings(!showSettings)} className="p-2 text-sand-600 hover:text-turquoise transition-colors">
                                <Settings className="w-6 h-6" />
                            </button>
                        </div>
                    </header>

                    {/* Settings Modal */}
                    {showSettings && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-sand-900/50 backdrop-blur-sm p-4 animate-fade-up">
                            <div className="bg-white p-6 rounded-2xl w-full max-w-md shadow-2xl relative border-2 border-sand-200">
                                <button onClick={() => setShowSettings(false)} className="absolute top-4 left-4 text-gray-400 hover:text-red-500"><X /></button>
                                <h3 className="font-serif text-xl text-sand-800 mb-4 flex items-center gap-2">
                                    <Key className="w-5 h-5 text-turquoise" /> ŸÖŸÅÿ™ÿßÿ≠ ÿßŸÑÿ∞ŸÉÿßÿ°
                                </h3>
                                <input 
                                    type="password" 
                                    value={apiKey}
                                    onChange={(e) => saveApiKey(e.target.value)}
                                    className="w-full bg-sand-50 border border-sand-300 rounded-xl p-3 text-sand-900 focus:outline-none focus:border-turquoise mb-2"
                                    placeholder="ÿ£ŸÑÿµŸÇ ÿßŸÑŸÖŸÅÿ™ÿßÿ≠ ÿßŸÑÿ≥ÿ±Ÿä ŸáŸÜÿß..."
                                />
                                <button onClick={() => setShowSettings(false)} className="mt-4 w-full bg-turquoise text-white py-3 rounded-xl font-bold hover:bg-teal-700 transition-colors">ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™</button>
                            </div>
                        </div>
                    )}

                    <main className="container mx-auto px-4 py-8 flex-1 max-w-5xl">
                        
                        {/* Input Area */}
                        <div className="bg-white rounded-[2rem] shadow-xl border border-sand-100 p-6 mb-12 relative overflow-hidden">
                            <div className="absolute top-0 right-0 w-32 h-32 bg-sand-100 rounded-bl-[100px] -z-0 opacity-50"></div>
                            
                            <label className="block text-sand-500 font-bold mb-4 flex items-center gap-2 relative z-10">
                                <BookOpen className="w-5 h-5" /> ÿßŸÑŸÜÿµ ÿßŸÑŸÅÿµŸäÿ≠ (ÿßŸÉÿ™ÿ® ŸáŸÜÿß)
                            </label>
                            
                            <textarea 
                                value={inputText}
                                onChange={(e) => setInputText(e.target.value)}
                                placeholder="ŸÖÿ´ÿßŸÑ: ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉ Ÿäÿß ÿµÿØŸäŸÇŸäÿü ÿßÿ¥ÿ™ŸÇÿ™ ÿ•ŸÑŸäŸÉ ŸÉÿ´Ÿäÿ±ÿßŸã..."
                                className="w-full h-32 text-xl md:text-2xl font-serif bg-transparent border-b-2 border-sand-200 focus:border-turquoise outline-none resize-none placeholder-sand-300 text-sand-900 relative z-10 leading-relaxed"
                            ></textarea>

                            <div className="mt-6 flex justify-end relative z-10">
                                <button 
                                    onClick={handleTranslate}
                                    disabled={isTranslating || !inputText}
                                    className={`
                                        px-8 py-4 rounded-xl font-bold text-lg flex items-center gap-3 transition-all shadow-lg
                                        ${isTranslating ? 'bg-sand-200 text-sand-500 cursor-wait' : 'bg-sand-800 text-white hover:bg-turquoise hover:scale-105'}
                                    `}
                                >
                                    {isTranslating ? (
                                        <>
                                            <Globe className="animate-spin" /> ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ...
                                        </>
                                    ) : (
                                        <>
                                            <ArrowRightLeft /> ÿ™ÿ±ÿ¨ŸÖ ŸÑŸÑŸáÿ¨ÿßÿ™
                                        </>
                                    )}
                                </button>
                            </div>
                        </div>

                        {/* Results Grid */}
                        <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                            
                            {!results && !isTranslating && (
                                <div className="md:col-span-2 lg:col-span-3 text-center py-20 opacity-40">
                                    <Languages className="w-24 h-24 mx-auto text-sand-400 mb-6" />
                                    <h2 className="text-3xl font-serif text-sand-600">ÿ®ÿßŸÜÿ™ÿ∏ÿßÿ± ŸÉŸÑŸÖÿßÿ™ŸÉ ÿßŸÑŸÅÿµŸäÿ≠ÿ©</h2>
                                    <p className="text-sand-500 mt-2">ÿßŸÉÿ™ÿ® ŸÜÿµÿßŸã ŸÑÿ™ÿ±Ÿâ ÿ≥ÿ≠ÿ± ÿßŸÑŸÑŸáÿ¨ÿßÿ™ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</p>
                                </div>
                            )}

                            {results && results.map((dialect, index) => {
                                const Icon = dialect.icon || Globe;
                                return (
                                    <div 
                                        key={index} 
                                        className="dialect-card bg-white rounded-2xl p-6 border border-sand-100 shadow-sm relative overflow-hidden animate-fade-up"
                                        style={{ animationDelay: `${index * 100}ms` }}
                                    >
                                        {/* Header */}
                                        <div className="flex justify-between items-start mb-4 border-b border-sand-100 pb-4">
                                            <div className="flex items-center gap-3">
                                                <span className="text-2xl">{dialect.flag}</span>
                                                <div>
                                                    <h3 className="font-serif text-xl text-sand-800">{dialect.name}</h3>
                                                </div>
                                            </div>
                                            <div className="text-sand-300">
                                                <Icon className="w-6 h-6 opacity-50" />
                                            </div>
                                        </div>

                                        {/* Translated Text */}
                                        <div className="min-h-[80px] mb-4">
                                            <p className="text-xl text-sand-900 font-medium leading-loose">
                                                {dialect.text}
                                            </p>
                                        </div>

                                        {/* Footnote (Vocabulary) */}
                                        {dialect.note && (
                                            <div className="bg-sand-50 p-3 rounded-lg text-sm text-sand-600 flex gap-2 items-start mb-4">
                                                <Sparkles className="w-4 h-4 text-turquoise shrink-0 mt-1" />
                                                <span>{dialect.note}</span>
                                            </div>
                                        )}

                                        {/* Copy Action */}
                                        <button 
                                            onClick={() => handleCopy(dialect.text, dialect.id)}
                                            className="w-full py-2 flex items-center justify-center gap-2 text-sand-500 hover:text-turquoise hover:bg-turquoise/5 rounded-lg transition-colors text-sm font-bold"
                                        >
                                            {copiedId === dialect.id ? <Check className="w-4 h-4" /> : <Copy className="w-4 h-4" />}
                                            {copiedId === dialect.id ? 'ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ' : 'ŸÜÿ≥ÿÆ ÿßŸÑŸÜÿµ'}
                                        </button>
                                    </div>
                                );
                            })}
                        </div>

                    </main>

                    {/* Footer Decoration */}
                    <div className="h-4 bg-pattern opacity-10 mt-auto"></div>
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>